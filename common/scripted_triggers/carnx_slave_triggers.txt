carnx_candidate_to_buy_slave_from_trigger = {
	is_ai = yes
	NOT = { this = scope:actor }
	highest_held_title_tier >= tier_county
	is_diplomatically_available = yes
	in_diplomatic_range = scope:actor
	NOT = { is_at_war_with = scope:actor }
	is_imprisoned = no
}

carnx_candidate_to_ransom_slave_trigger = {
	NOT = { this = scope:actor }
	highest_held_title_tier >= tier_county
	is_diplomatically_available = yes
	in_diplomatic_range = scope:actor
	NOT = { is_at_war_with = scope:actor }
	is_imprisoned = no
}

carnx_slave_can_be_freed_trigger = {
	NOR = {
		has_character_flag = carn_slave_cannot_be_freed
		has_trait_with_flag = carn_slave_cannot_be_freed
	}
	trigger_if = {
		limit = { exists = imprisoner }
		has_relation_slave_owner = imprisoner
	}
}

carnx_buy_sell_slave_recipient_trigger = {
	$RULER$ = {
		is_ruler = yes
	}
	OR = {
		any_neighboring_and_across_water_top_liege_realm_owner = {
			this = $RULER$
		}
		trigger_if = {
			limit = { exists = top_liege }
			top_liege = {
				any_vassal_or_below = {
					this = $RULER$
				}
			}
		}
		trigger_if = {
			limit = { NOT = { exists = top_liege } }
			any_vassal_or_below = {
				this = $RULER$
			}
		}
	}
}

carnx_has_important_role_trigger = {
	any_relation = {
		type = ward
		OR = {
			this = $RULER$
			is_close_family_of = $RULER$
		}
	}
	any_relation = {
		type = guardian
		OR = {
			this = $RULER$
			is_close_family_of = $RULER$
		}
	}
	any_relation = {
		type = mentor
		OR = {
			this = $RULER$
			is_close_family_of = $RULER$
		}
	}
	any_relation = {
		type = student
		OR = {
			this = $RULER$
			is_close_family_of = $RULER$
		}
	}
}

# Does the scoped character have a valid reason to execute $CHARACTER$.
# In addition to having an explicit execute reason, this also includes
# $CHARACTER$ being a rival / nemesis, a cheating spouse, or a ruler you can inherit land from.
carnx_has_execute_reason_trigger = {
	OR = {
		has_execute_reason = $CHARACTER$
		has_relation_rival = $CHARACTER$ # Execute rivals
		has_relation_nemesis = $CHARACTER$ # Execute rivals
		$CHARACTER$ = {
			is_spouse_of = prev
			exposed_cheating_on_spouse_trigger = { SPOUSE = prev }
		}
		any_heir_title = { # Execute rulers you can inherit land from
			exists = holder
			holder = $CHARACTER$
			place_in_line_of_succession = {
				target = prev
				value > 2
			}
		}
	}
}

# Is the scoped character a family or a positive relation of $CHARACTER$.
carnx_is_family_or_positive_relation_trigger = {
	OR = {
		has_relation_best_friend = $CHARACTER$
		has_relation_soulmate = $CHARACTER$
		has_relation_friend = $CHARACTER$
		has_relation_lover = $CHARACTER$
		has_secret_relation_lover = $CHARACTER$
		has_relation_crush = $CHARACTER$
		is_spouse_of = $CHARACTER$
		is_close_or_extended_family_of = $CHARACTER$
		dynasty = $CHARACTER$.dynasty
	}
	NOR = {
		has_relation_rival = $CHARACTER$
		has_relation_nemesis = $CHARACTER$
	}
}

# Is owning slaves of $CHARACTER$'s faith shunned according to the scoped character's faith.
carnx_is_slavery_shunned_trigger = {
	OR = {
		faith = {
			has_doctrine = carn_doctrine_same_slavery_shunned
			faith_hostility_level = {
				target = $CHARACTER$.faith
				value < faith_hostile_level
			}
		}
		faith = {
			has_doctrine = carn_doctrine_other_slavery_shunned
			faith_hostility_level = {
				target = $CHARACTER$.faith
				value >= faith_hostile_level
			}
		}
	}
}

# Is owning slaves of $CHARACTER$'s faith a crime according to the scoped character's faith.
carnx_is_slavery_crime_trigger = {
	$CHARACTER$ = { save_temporary_scope_as = other }
	OR = {
		faith = {
			has_doctrine = carn_doctrine_same_slavery_crime
			faith_hostility_level = {
				target = scope:other.faith
				value < faith_hostile_level
			}
		}
		faith = {
			has_doctrine = carn_doctrine_other_slavery_crime
			faith_hostility_level = {
				target = scope:other.faith
				value >= faith_hostile_level
			}
		}
	}
}

# Enable nudity in slavery related events
carnx_enable_nudity = {
	always = yes
}

is_diplomatically_available = {
	is_busy_in_events_localised = yes
}
